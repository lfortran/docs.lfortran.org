
<!DOCTYPE html>

<html lang="zh_CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>安装 &#8212; LFortran</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ansi.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/lfortran-logo.svg"/>
    <link rel="index" title="索引" href="../genindex/" />
    <link rel="search" title="搜索" href="../search/" />
    <link rel="next" title="Fortran 语言" href="../language/" />
    <link rel="prev" title="LFortran 文档" href="../" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=amber data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#installation" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../" title="LFortran"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/lfortran-logo.svg" height="26"
                   alt="LFortran logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">LFortran Documentation</span>
          <span class="md-header-nav__topic"> 安装 </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search/" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
          </div>
        </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Versions</button>
    <div class="dropdown-content md-hero">
          <a title="English" href="/../en/">English</a>
      
          <a title="Bengali" href="/../bn/">Bengali</a>
      
          <a title="Czech" href="/../cs/">Czech</a>
      
          <a title="German" href="/../de/">German</a>
      
          <a title="Spanish" href="/../es/">Spanish</a>
      
          <a title="French" href="/../fr/">French</a>
      
          <a title="Japanese" href="/../ja/">Japanese</a>
      
          <a title="Dutch" href="/../nl/">Dutch</a>
      
          <a title="Polish" href="/../pl/">Polish</a>
      
          <a title="Portuguese" href="/../pt/">Portuguese</a>
      
          <a title="Russian" href="/../ru/">Russian</a>
      
          <a title="Chinese" href="/../zh_CN/">Chinese</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../" class="md-tabs__link">LFortran</a></li>
            
            <li class="md-tabs__item"><a href="#" class="md-tabs__link">Getting started</a></li>
            
            <li class="md-tabs__item"><a href="../progress/" class="md-tabs__link">LFortran Development Status</a></li>
            
            <li class="md-tabs__item"><a href="../design/" class="md-tabs__link">Developers's Guide</a></li>
            
            <li class="md-tabs__item"><a href="../intrinsics/array/" class="md-tabs__link">Intrinsics</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../" title="LFortran" class="md-nav__button md-logo">
      
        <img src="../_static/lfortran-logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../"
       title="LFortran">LFortran Documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">开始</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> 安装 </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">安装</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#installation--page-root" class="md-nav__link">安装</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#binaries" class="md-nav__link">二进制文件</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-a-source-tarball" class="md-nav__link">从源代码构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git" class="md-nav__link">从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-on-windows-with-visual-studio" class="md-nav__link">在 Windows 上使用 Visual Studio 从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-on-windows-with-wsl" class="md-nav__link">用 WSL 在 Windows上 从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#enabling-the-jupyter-kernel" class="md-nav__link">启用 Jupyter 内核</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-with-nix" class="md-nav__link">使用 Nix 从 Git 构建</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#with-root" class="md-nav__link">带有 root 权限</a>
        </li>
        <li class="md-nav__item"><a href="#without-root" class="md-nav__link">不带有 root 权限</a>
        </li>
        <li class="md-nav__item"><a href="#development" class="md-nav__link">开发</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#note-about-dependencies" class="md-nav__link">关于依赖性的说明</a>
        </li>
        <li class="md-nav__item"><a href="#note-for-users-who-do-not-use-conda" class="md-nav__link">不使用 Conda 的用户注意</a>
        </li>
        <li class="md-nav__item"><a href="#stacktraces" class="md-nav__link">堆栈跟踪</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#llvm" class="md-nav__link">LLVM</a>
        </li>
        <li class="md-nav__item"><a href="#ubuntu" class="md-nav__link">Ubuntu</a>
        </li>
        <li class="md-nav__item"><a href="#macos" class="md-nav__link">macOS</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#tests" class="md-nav__link">Tests</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#run-tests" class="md-nav__link">运行测试:</a>
        </li>
        <li class="md-nav__item"><a href="#update-test-references" class="md-nav__link">Update test references:</a>
        </li>
        <li class="md-nav__item"><a href="#run-integration-tests" class="md-nav__link">Run integration tests</a>
        </li>
        <li class="md-nav__item"><a href="#speed-up-integration-tests-on-macos" class="md-nav__link">Speed up integration tests on macOS</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#binaries" class="md-nav__link">二进制文件</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#build-from-a-source-tarball" class="md-nav__link">从源代码构建</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#build-from-git" class="md-nav__link">从 Git 构建</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#build-from-git-on-windows-with-visual-studio" class="md-nav__link">在 Windows 上使用 Visual Studio 从 Git 构建</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#build-from-git-on-windows-with-wsl" class="md-nav__link">用 WSL 在 Windows上 从 Git 构建</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#enabling-the-jupyter-kernel" class="md-nav__link">启用 Jupyter 内核</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#build-from-git-with-nix" class="md-nav__link">使用 Nix 从 Git 构建</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#note-about-dependencies" class="md-nav__link">关于依赖性的说明</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#note-for-users-who-do-not-use-conda" class="md-nav__link">不使用 Conda 的用户注意</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#stacktraces" class="md-nav__link">堆栈跟踪</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#tests" class="md-nav__link">Tests</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language/" class="md-nav__link">Fortran 语言</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/" class="md-nav__link">LFortran User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran 开发现状</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/" class="md-nav__link">LFortran 开发现状</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/#topics" class="md-nav__link">话题</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">开发者指南</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../design/" class="md-nav__link">LFortran Design</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../developer_tutorial/" class="md-nav__link">开发者教程</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../ast_and_asr/" class="md-nav__link">AST 和 ASR 之间的区别</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contributing/" class="md-nav__link">贡献</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran 内置函数</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/array/" class="md-nav__link">数组内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/bit/" class="md-nav__link">位操作内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/character/" class="md-nav__link">字符内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/kind-type/" class="md-nav__link">种类类型内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/mathematical/" class="md-nav__link">数学内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/numeric/" class="md-nav__link">数值内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/misc/" class="md-nav__link">其他内置函数</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran ASR Nodes</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/cast_kind_nodes/cast_kind/" class="md-nav__link">cast_kind</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/expression_nodes/expression_nodes/" class="md-nav__link">ASR Expression Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/kinds_nodes/kinds/" class="md-nav__link">kinds</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/statement_nodes/statement_nodes/" class="md-nav__link">ASR Statement Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/symbol_nodes/symbol_nodes/" class="md-nav__link">ASR Symbol Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/type_nodes/ttype/" class="md-nav__link">ttype</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#installation--page-root" class="md-nav__link">安装</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#binaries" class="md-nav__link">二进制文件</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-a-source-tarball" class="md-nav__link">从源代码构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git" class="md-nav__link">从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-on-windows-with-visual-studio" class="md-nav__link">在 Windows 上使用 Visual Studio 从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-on-windows-with-wsl" class="md-nav__link">用 WSL 在 Windows上 从 Git 构建</a>
        </li>
        <li class="md-nav__item"><a href="#enabling-the-jupyter-kernel" class="md-nav__link">启用 Jupyter 内核</a>
        </li>
        <li class="md-nav__item"><a href="#build-from-git-with-nix" class="md-nav__link">使用 Nix 从 Git 构建</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#with-root" class="md-nav__link">带有 root 权限</a>
        </li>
        <li class="md-nav__item"><a href="#without-root" class="md-nav__link">不带有 root 权限</a>
        </li>
        <li class="md-nav__item"><a href="#development" class="md-nav__link">开发</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#note-about-dependencies" class="md-nav__link">关于依赖性的说明</a>
        </li>
        <li class="md-nav__item"><a href="#note-for-users-who-do-not-use-conda" class="md-nav__link">不使用 Conda 的用户注意</a>
        </li>
        <li class="md-nav__item"><a href="#stacktraces" class="md-nav__link">堆栈跟踪</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#llvm" class="md-nav__link">LLVM</a>
        </li>
        <li class="md-nav__item"><a href="#ubuntu" class="md-nav__link">Ubuntu</a>
        </li>
        <li class="md-nav__item"><a href="#macos" class="md-nav__link">macOS</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#tests" class="md-nav__link">Tests</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#run-tests" class="md-nav__link">运行测试:</a>
        </li>
        <li class="md-nav__item"><a href="#update-test-references" class="md-nav__link">Update test references:</a>
        </li>
        <li class="md-nav__item"><a href="#run-integration-tests" class="md-nav__link">Run integration tests</a>
        </li>
        <li class="md-nav__item"><a href="#speed-up-integration-tests-on-macos" class="md-nav__link">Speed up integration tests on macOS</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="installation">
<h1 id="installation--page-root">安装<a class="headerlink" href="#installation--page-root" title="永久链接至标题">¶</a></h1>
<p>以下所有说明适用于 Linux、macOS 和 Windows。</p>
<section id="binaries">
<h2 id="binaries">二进制文件<a class="headerlink" href="#binaries" title="永久链接至标题">¶</a></h2>
<p>安装 LFortran 的推荐方法是使用 Conda。例如，按照你的平台的说明安装 <a class="reference external" href="https://conda.io/en/latest/miniconda.html">Miniconda</a>，安装 Conda。然后创建一个新环境（你可以选择任何名称，这里我们选择了<code class="docutils literal notranslate"><span class="pre">lf</span></code>）并激活它：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>lf
conda<span class="w"> </span>activate<span class="w"> </span>lf
</pre></div>
</div>
<p>然后通过以下方式安装 LFortran：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>lfortran<span class="w"> </span>-c<span class="w"> </span>conda-forge
</pre></div>
</div>
<p>现在 <code class="docutils literal notranslate"><span class="pre">lf</span></code> 环境有 <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> 编译器可用，你可以通过执行 <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> 启动交互式提示，或使用 <code class="docutils literal notranslate"><span class="pre">lfortran</span> <span class="pre">-h</span></code> 查看命令行选项。</p>
<p>Jupyter 内核是通过上面的命令自动安装的，所以在安装 Jupyter 本身之后：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>jupyter<span class="w"> </span>-c<span class="w"> </span>conda-forge
</pre></div>
</div>
<p>你可以通过执行以下命令来创建基于 Fortran 的 Jupyter 笔记本：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>jupyter<span class="w"> </span>notebook
</pre></div>
</div>
<p>并选择 <code class="docutils literal notranslate"><span class="pre">New-&gt;Fortran</span></code>。</p>
</section>
<section id="build-from-a-source-tarball">
<h2 id="build-from-a-source-tarball">从源代码构建<a class="headerlink" href="#build-from-a-source-tarball" title="永久链接至标题">¶</a></h2>
<p>如果你只想自己或在包管理器（Spack、Conda、Debian 等）中安装 LFortran，建议使用此方法。源代码包含所有生成的文件，并且具有最小的依赖关系。</p>
<p>The source tarball of LFortran depends on:</p>
<ul class="simple">
<li><p>Python</p></li>
<li><p>cmake</p></li>
<li><p>LLVM 10-19</p></li>
<li><p>zstd-static</p></li>
<li><p>zlib</p></li>
</ul>
<p>首先，我们必须安装依赖项，例如使用 Conda：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>create<span class="w"> </span>-n<span class="w"> </span>lf<span class="w"> </span>python<span class="w"> </span>cmake<span class="w"> </span>llvmdev<span class="w"> </span>zstd-static<span class="w"> </span>zlib
conda<span class="w"> </span>activate<span class="w"> </span>lf
</pre></div>
</div>
<p>On a Linux system, we additionally need to install <code class="docutils literal notranslate"><span class="pre">libunwind</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>install<span class="w"> </span>libunwind
</pre></div>
</div>
<p>然后从 <a class="reference external" href="https://lfortran.org/download/">https://lfortran.org/download/</a> 下载源代码，例如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/lfortran/lfortran/releases/download/v0.42.0/lfortran-0.42.0.tar.gz
tar<span class="w"> </span>xzf<span class="w"> </span>lfortran-0.42.0.tar.gz
<span class="nb">cd</span><span class="w"> </span>lfortran-0.42.0
</pre></div>
</div>
<p>并构建：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cmake -DWITH_LLVM=yes -DCMAKE_INSTALL_PREFIX=`pwd`/inst .
make -j8
make install
</pre></div>
</div>
<p>This will install <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> into <code class="docutils literal notranslate"><span class="pre">inst/bin</span></code>.  It assumes that c++ and cc are available, which on Linux
are typically the GNU C++/C compilers.</p>
</section>
<section id="build-from-git">
<h2 id="build-from-git">从 Git 构建<a class="headerlink" href="#build-from-git" title="永久链接至标题">¶</a></h2>
<p>我们假设你安装了 C++ 编译器，以及 <code class="docutils literal notranslate"><span class="pre">git</span></code> 和 <code class="docutils literal notranslate"><span class="pre">wget</span></code>。在 Ubuntu 中，你还可以为 stacktraces 安装 <code class="docutils literal notranslate"><span class="pre">binutils-dev</span></code>。</p>
<p>如果你没有安装 Conda，你可以在 Linux 上安装（在其他平台上类似）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>--no-check-certificate<span class="w"> </span>https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh<span class="w"> </span>-O<span class="w"> </span>miniconda.sh
bash<span class="w"> </span>miniconda.sh<span class="w"> </span>-b<span class="w"> </span>-p<span class="w"> </span><span class="nv">$HOME</span>/conda_root
<span class="nb">export</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span><span class="s2">"</span><span class="nv">$HOME</span><span class="s2">/conda_root/bin:</span><span class="nv">$PATH</span><span class="s2">"</span>
</pre></div>
</div>
<p>克隆 LFortran git 存储库：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lfortran</span><span class="o">/</span><span class="n">lfortran</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">lfortran</span>
</pre></div>
</div>
<p>然后准备环境：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment_linux.yml
conda<span class="w"> </span>activate<span class="w"> </span>lf
</pre></div>
</div>
<p>生成构建所需的文件（此步骤取决于 <code class="docutils literal notranslate"><span class="pre">re2c</span></code>、<code class="docutils literal notranslate"><span class="pre">bison</span></code> 和 <code class="docutils literal notranslate"><span class="pre">python</span></code>）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build0.sh
</pre></div>
</div>
<p>Now you can use our script <code class="docutils literal notranslate"><span class="pre">./build1.sh</span></code> to build in Debug mode:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build1.sh
</pre></div>
</div>
<p>and can use <code class="docutils literal notranslate"><span class="pre">ninja</span></code> to rebuild.</p>
<p>To do a clean rebuild, you can use:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># NOTE: the below git command deletes all untracked files</span>
git<span class="w"> </span>clean<span class="w"> </span>-dfx<span class="w">  </span><span class="c1"># reset repository to a clean state by removing artifacts generated during the build process</span>
./build0.sh
./build1.sh
</pre></div>
</div>
<p>运行交互式提示符:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./src/bin/lfortran
</pre></div>
</div>
<p>See <span class="xref myst">how to run tests</span> to make sure all tests pass</p>
</section>
<section id="build-from-git-on-windows-with-visual-studio">
<h2 id="build-from-git-on-windows-with-visual-studio">在 Windows 上使用 Visual Studio 从 Git 构建<a class="headerlink" href="#build-from-git-on-windows-with-visual-studio" title="永久链接至标题">¶</a></h2>
<p>安装 Visual Studio (MSVC)，例如 2022 版本，可以免费下载社区版本：https://visualstudio.microsoft.com/downloads/ 。</p>
<p>使用来自 https://github.com/conda-forge/miniforge 的 Windows 安装程序安装 miniforge。</p>
<p>从桌面上启动 Miniforge Prompt。</p>
<p>在 shell 中，用以下方法初始化 MSVC 编译器:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">call</span> <span class="s2">"C:\Program Files\Microsoft Visual Studio</span><span class="se">\202</span><span class="s2">2\Community\Common7\Tools\VsDevCmd"</span> <span class="o">-</span><span class="n">arch</span><span class="o">=</span><span class="n">x64</span>
</pre></div>
</div>
<p>你可以选择通过以下方式测试 MSVC 是否工作:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cl /?
link /?
</pre></div>
</div>
<p>这两个命令都必须打印帮助信息（若干页）。</p>
<p>现在你可以下载并建立 LFortran：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">lfortran</span><span class="o">/</span><span class="n">lfortran</span><span class="o">.</span><span class="n">git</span>
<span class="n">cd</span> <span class="n">lfortran</span>
<span class="n">conda</span> <span class="n">env</span> <span class="n">create</span> <span class="o">-</span><span class="n">f</span> <span class="n">environment_win</span><span class="o">.</span><span class="n">yml</span>
<span class="n">conda</span> <span class="n">activate</span> <span class="n">lf</span>
<span class="n">build0</span><span class="o">.</span><span class="n">bat</span>
<span class="n">build1</span><span class="o">.</span><span class="n">bat</span>
</pre></div>
</div>
<p>如果一切都编译好了，那么你就可以使用 LFortran，如下所示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inst</span>\<span class="nb">bin</span>\<span class="n">lfortran</span> <span class="n">examples</span><span class="o">/</span><span class="n">expr2</span><span class="o">.</span><span class="n">f90</span>
<span class="n">expr2</span><span class="o">.</span><span class="n">exe</span>
<span class="n">inst</span>\<span class="nb">bin</span>\<span class="n">lfortran</span>
</pre></div>
</div>
<p>等等 。</p>
<p>注意：LFortran 目前使用 MSVC 的链接器程序（<code class="docutils literal notranslate"><span class="pre">link</span></code>），只有在运行上面的 MSVC bat 脚本时才能使用。如果你忘记激活它，LFortran 的链接就会失败。</p>
<p>注意：miniforge shell 似乎在运行某个版本的 <code class="docutils literal notranslate"><span class="pre">git-bash</span></code>（尽管它是<code class="docutils literal notranslate"><span class="pre">cmd.exe</span></code>），它有一些类似 unix 的文件系统挂载在 <code class="docutils literal notranslate"><span class="pre">/usr</span></code>，有几个命令可用，如<code class="docutils literal notranslate"><span class="pre">ls</span></code>、<code class="docutils literal notranslate"><span class="pre">which</span></code>、<code class="docutils literal notranslate"><span class="pre">git</span></code>、<code class="docutils literal notranslate"><span class="pre">vim</span></code>。 由于这个原因，Conda 构建的 <code class="docutils literal notranslate"><span class="pre">environment_win.yml</span></code> 包含了所有需要的东西，包括 <code class="docutils literal notranslate"><span class="pre">git</span></code>。</p>
</section>
<section id="build-from-git-on-windows-with-wsl">
<h2 id="build-from-git-on-windows-with-wsl">用 WSL 在 Windows上 从 Git 构建<a class="headerlink" href="#build-from-git-on-windows-with-wsl" title="永久链接至标题">¶</a></h2>
<ul class="simple">
<li><p>在 Windows 中搜索“打开或关闭 Windows 功能”。</p></li>
<li><p>标记适用于Linux 的 Windows 子系统。</p></li>
<li><p>按“确定”并重新启动计算机。</p></li>
<li><p>Go to Microsoft store and download Ubuntu (20.04 or 22.04 or 24.04), and launch it.</p></li>
<li><p>Now setup LFortran by running the following commands.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w">  </span>https://github.com/conda-forge/miniforge/releases/latest/download/Miniforge3-Linux-x86_64.sh<span class="w"> </span>-O<span class="w"> </span>miniconda.sh
bash<span class="w"> </span>miniconda.sh<span class="w"> </span>-b<span class="w"> </span>-p<span class="w"> </span><span class="nv">$HOME</span>/conda_root
<span class="nb">echo</span><span class="w"> </span><span class="s2">"export PATH=</span><span class="nv">$HOME</span><span class="s2">/conda_root/bin:</span><span class="nv">$PATH</span><span class="s2">"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>~/.bashrc
</pre></div>
</div>
<ul class="simple">
<li><p>After that restart the Ubuntu terminal.</p></li>
<li><p>Now clone the LFortran git repository (you should clone it inside a linux owned directory like <code class="docutils literal notranslate"><span class="pre">~</span></code> or  any of its sub-directories).</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>~
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/lfortran/lfortran.git
<span class="nb">cd</span><span class="w"> </span>lfortran
</pre></div>
</div>
<ul class="simple">
<li><p>运行以下内容</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>env<span class="w"> </span>create<span class="w"> </span>-f<span class="w"> </span>environment_linux.yml
conda<span class="w"> </span>init<span class="w"> </span>bash
</pre></div>
</div>
<ul class="simple">
<li><p>Restart Ubuntu terminal again</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>lf
sudo<span class="w"> </span>apt<span class="w"> </span>update
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>build-essential
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>zlib1g-dev<span class="w"> </span>libzstd-dev
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>clang
</pre></div>
</div>
<ul class="simple">
<li><p>运行以下命令</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>activate<span class="w"> </span>lf
./build0.sh
cmake<span class="w"> </span>-DCMAKE_BUILD_TYPE<span class="o">=</span>Debug<span class="w"> </span>-DWITH_LLVM<span class="o">=</span>yes<span class="w"> </span>-DCMAKE_INSTALL_PREFIX<span class="o">=</span><span class="sb">`</span><span class="nb">pwd</span><span class="sb">`</span>/inst<span class="w"> </span>.
make<span class="w"> </span>-j8
</pre></div>
</div>
<ul class="simple">
<li><p>如果一切都能编译，你可以使用 LFortran，如下所示</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./src/bin/lfortran<span class="w"> </span>./examples/expr2.f90
./expr2.out
</pre></div>
</div>
<ul class="simple">
<li><p>运行交互式提示符</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./src/bin/lfortran
</pre></div>
</div>
<p>See <span class="xref myst">how to run tests</span> to make sure all tests pass</p>
</section>
<section id="enabling-the-jupyter-kernel">
<h2 id="enabling-the-jupyter-kernel">启用 Jupyter 内核<a class="headerlink" href="#enabling-the-jupyter-kernel" title="永久链接至标题">¶</a></h2>
<p>要安装 Jupyter 内核，还要安装以下 Conda 软件包:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">install</span> <span class="n">xeus</span><span class="o">=</span><span class="mf">5.1.0</span> <span class="n">xeus</span><span class="o">-</span><span class="n">zmq</span><span class="o">=</span><span class="mf">3.0.0</span> <span class="n">nlohmann_json</span>
</pre></div>
</div>
<p>并通过 <code class="docutils literal notranslate"><span class="pre">-DWITH_XEUS=yes</span></code> 启用内核，然后安装到 <code class="docutils literal notranslate"><span class="pre">$CONDA_PREFIX</span></code>。比如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cmake</span> \
    <span class="o">-</span><span class="n">DCMAKE_BUILD_TYPE</span><span class="o">=</span><span class="n">Debug</span> \
    <span class="o">-</span><span class="n">DWITH_LLVM</span><span class="o">=</span><span class="n">yes</span> \
    <span class="o">-</span><span class="n">DWITH_XEUS</span><span class="o">=</span><span class="n">yes</span> \
    <span class="o">-</span><span class="n">DCMAKE_PREFIX_PATH</span><span class="o">=</span><span class="s2">"$CONDA_PREFIX"</span> \
    <span class="o">-</span><span class="n">DCMAKE_INSTALL_PREFIX</span><span class="o">=</span><span class="s2">"$CONDA_PREFIX"</span> \
    <span class="o">.</span>
<span class="n">cmake</span> <span class="o">--</span><span class="n">build</span> <span class="o">.</span> <span class="o">-</span><span class="n">j4</span> <span class="o">--</span><span class="n">target</span> <span class="n">install</span>
</pre></div>
</div>
<p>要使用它，请安装 Jupyter（<code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">install</span> <span class="pre">jupyter</span></code>）并测试是否找到 LFortran 内核:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">kernelspec</span> <span class="nb">list</span> <span class="o">--</span><span class="n">json</span>
</pre></div>
</div>
<p>然后启动 Jupyter notebook，如下所示:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">notebook</span>
</pre></div>
</div>
<p>单击 <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">-</span> <span class="pre">&gt;</span> <span class="pre">Fortran</span></code>。启动 jupyter LFortran 终端控制台：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">jupyter</span> <span class="n">console</span> <span class="o">--</span><span class="n">kernel</span><span class="o">=</span><span class="n">fortran</span>
</pre></div>
</div>
</section>
<section id="build-from-git-with-nix">
<h2 id="build-from-git-with-nix">使用 Nix 从 Git 构建<a class="headerlink" href="#build-from-git-with-nix" title="永久链接至标题">¶</a></h2>
<p>确保精确环境和依赖关系的方法之一是使用 <code class="docutils literal notranslate"><span class="pre">nix</span></code>。这将确保系统的依赖性不会干扰到开发环境。如果你愿意，你可以在 <code class="docutils literal notranslate"><span class="pre">nix-shell</span></code> 环境下报告 bug，以方便别人复制。</p>
<section id="with-root">
<h3 id="with-root">带有 root 权限<a class="headerlink" href="#with-root" title="永久链接至标题">¶</a></h3>
<p>我们从获得 <code class="docutils literal notranslate"><span class="pre">nix</span></code> 开始。下面的多用户安装将在任何装有 Linux 发行版、MacOS 或 Windows（通过 WSL）的机器上工作：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>&lt;<span class="o">(</span>curl<span class="w"> </span>-L<span class="w"> </span>https://nixos.org/nix/install<span class="o">)</span><span class="w"> </span>--daemon
</pre></div>
</div>
</section>
<section id="without-root">
<h3 id="without-root">不带有 root 权限<a class="headerlink" href="#without-root" title="永久链接至标题">¶</a></h3>
<p>如果你想不给<code class="docutils literal notranslate"><span class="pre">nix</span></code>提供机器的root权限，在Linux发行版上，我们可以使用 <a class="reference external" href="https://github.com/DavHau/nix-portable">nix-portable</a>.。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://github.com/DavHau/nix-portable/releases/download/v003/nix-portable
</pre></div>
</div>
<p>现在只要在所有 <code class="docutils literal notranslate"><span class="pre">nix-shell</span> </code>命令前加上 <code class="docutils literal notranslate"><span class="pre">NP_RUNTIME=bwrap</span> <span class="pre">.</span> <span class="pre">/nix-portable</span></code>。所以：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Do not</span>
nix-shell<span class="w"> </span>--run<span class="w"> </span><span class="s2">"bash"</span>
<span class="c1"># Do</span>
<span class="nv">NP_RUNTIME</span><span class="o">=</span>bwrap<span class="w"> </span>./nix-portable<span class="w"> </span>nix-shell<span class="w"> </span>--run<span class="w"> </span><span class="s2">"bash"</span>
</pre></div>
</div>
</section>
<section id="development">
<h3 id="development">开发<a class="headerlink" href="#development" title="永久链接至标题">¶</a></h3>
<p>现在进入开发环境:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nix-shell<span class="w"> </span>--run<span class="w"> </span><span class="s2">"bash"</span><span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w"> </span>-j4<span class="w"> </span>--pure<span class="w"> </span>ci/shell.nix
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">--pure</span></code> 标志确保在环境中不使用系统依赖。</p>
<p>构建步骤与 <code class="docutils literal notranslate"><span class="pre">ci</span> </code> 相同:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./build0.sh
./build1.sh
</pre></div>
</div>
<p>要把编译环境从 <code class="docutils literal notranslate"><span class="pre">gcc</span></code>（默认）改为 <code class="docutils literal notranslate"><span class="pre">clang</span></code>，我们可以使用 <code class="docutils literal notranslate"><span class="pre">--argstr</span></code>：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nix-shell<span class="w"> </span>--run<span class="w"> </span><span class="s2">"bash"</span><span class="w"> </span>--cores<span class="w"> </span><span class="m">4</span><span class="w"> </span>-j4<span class="w"> </span>--pure<span class="w"> </span>ci/shell.nix<span class="w"> </span>--argstr<span class="w"> </span>clangOnly<span class="w"> </span><span class="s2">"yes"</span>
</pre></div>
</div>
</section>
</section>
<section id="note-about-dependencies">
<h2 id="note-about-dependencies">关于依赖性的说明<a class="headerlink" href="#note-about-dependencies" title="永久链接至标题">¶</a></h2>
<p>我们鼓励终端用户（和发行版）使用来自 <a class="reference external" href="https://lfortran.org/download/">https://lfortran.org/download/</a>的tarball，它只依赖于LLVM、CMake和C++编译器。</p>
<p>这个 tarball 是由我们的 CI（持续集成）自动生成的，包含一些自动生成的文件：解析器、AST 和 ASR 节点，由 ASDL 翻译器生成（需要 Python）。</p>
<p>在开发 LFortran 本身时要使用来自 git 的指令。</p>
</section>
<section id="note-for-users-who-do-not-use-conda">
<h2 id="note-for-users-who-do-not-use-conda">不使用 Conda 的用户注意<a class="headerlink" href="#note-for-users-who-do-not-use-conda" title="永久链接至标题">¶</a></h2>
<p>以下是在开发模式下安装此版本库的必要依赖，</p>
<ul class="simple">
<li><p><a class="reference external" href="https://ftp.gnu.org/gnu/bison/bison-3.5.1.tar.xz">Bison - 3.5.1</a></p></li>
<li><p><a class="reference external" href="https://github.com/llvm/llvm-project/releases/download/llvmorg-11.0.1/llvm-11.0.1.src.tar.xz">LLVM - 11.0.1</a></p></li>
<li><p><a class="reference external" href="https://re2c.org/install/install.html">re2c - 2.0.3</a></p></li>
<li><p><a class="reference external" href="ftp://sourceware.org/pub/binutils/snapshots/binutils-2.31.90.tar.xz">binutils - 2.31.90</a> —— 确保你应该启用与此依赖关系相关的必要选项来构建动态库（以 <code class="docutils literal notranslate"><span class="pre">.so</span></code> 结尾的库）。</p></li>
</ul>
</section>
<section id="stacktraces">
<h2 id="stacktraces">堆栈跟踪<a class="headerlink" href="#stacktraces" title="永久链接至标题">¶</a></h2>
<p>LFortran 可以在出现未处理的异常时打印堆栈跟踪，也可以在任何编译器错误时使用 <code class="docutils literal notranslate"><span class="pre">--show-stacktrace</span></code> 选项。这对开发编译器本身很有帮助，可以看到 LFortran 中的问题所在。默认情况下，堆栈跟踪支持是关闭的，要启用它，需要在每个平台上按照下面的说明安装先决条件后，用<code class="docutils literal notranslate"><span class="pre">-DWITH_STACKTRACE=yes</span></code> cmake 选项编译 LFortran。</p>
<section id="llvm">
<h3 id="llvm">LLVM<a class="headerlink" href="#llvm" title="永久链接至标题">¶</a></h3>
<p>In all platforms having LLVM, stacktraces can be shown with LLVM, so no
additional prerequisites are required. If LLVM is not available, you can use
the following instructions, depending on your platform.</p>
</section>
<section id="ubuntu">
<h3 id="ubuntu">Ubuntu<a class="headerlink" href="#ubuntu" title="永久链接至标题">¶</a></h3>
<p>在 Ubuntu 系统，<code class="docutils literal notranslate"><span class="pre">apt</span> <span class="pre">install</span> <span class="pre">binutils-dev</span></code>。</p>
</section>
<section id="macos">
<h3 id="macos">macOS<a class="headerlink" href="#macos" title="永久链接至标题">¶</a></h3>
<p>如果你在 macOS 上使用默认的 Clang 编译器，那么堆栈跟踪应该正好在基于 Intel 和 M1 的 macOS 上工作（CMake 构建系统自动调用 <code class="docutils literal notranslate"><span class="pre">dsymtuil</span></code> 工具和我们的 Python 脚本来存储调试信息，更多细节见 <code class="docutils literal notranslate"><span class="pre">src/bin/CMakeLists.txt</span></code>）。如果不能工作，请报告一个错误。</p>
<p>如果你不喜欢默认的方式，另一个选择是使用bintutils。为此，首先安装 <a class="reference external" href="https://spack.io/">Spack</a>，然后：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">spack</span> <span class="n">install</span> <span class="n">binutils</span>
<span class="n">spack</span> <span class="n">find</span> <span class="o">-</span><span class="n">p</span> <span class="n">binutils</span>
</pre></div>
</div>
<p>最后一条命令将显示已安装的 <code class="docutils literal notranslate"><span class="pre">binutils</span></code> 软件包的完整路径。把这个路径添加到你的 shell 配置文件中，例如：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">CMAKE_PREFIX_PATH_LFORTRAN</span><span class="o">=/</span><span class="n">Users</span><span class="o">/</span><span class="n">ondrej</span><span class="o">/</span><span class="n">repos</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">spack</span><span class="o">/</span><span class="n">darwin</span><span class="o">-</span><span class="n">catalina</span><span class="o">-</span><span class="n">broadwell</span><span class="o">/</span><span class="n">apple</span><span class="o">-</span><span class="n">clang</span><span class="o">-</span><span class="mf">11.0.0</span><span class="o">/</span><span class="n">binutils</span><span class="o">-</span><span class="mf">2.36.1</span><span class="o">-</span><span class="n">wy6osfm6bp2323g3jpv2sjuttthwx3gd</span>
</pre></div>
</div>
<p>并使用 <code class="docutils literal notranslate"><span class="pre">-DCMAKE_PREFIX_PATH="$CMAKE_PREFIX_PATH_LFORTRAN;$CONDA_PREFIX"</span></code> cmake 选项编译 LFortran。<code class="docutils literal notranslate"><span class="pre">$CONDA_PREFIX</span></code> 是在你使用 Conda 安装了一些其他的依赖项（如 <code class="docutils literal notranslate"><span class="pre">llvm</span></code>）的情况下出现的，否则你可以把它删除。</p>
</section>
</section>
<section id="tests">
<h2 id="tests">Tests<a class="headerlink" href="#tests" title="永久链接至标题">¶</a></h2>
<section id="run-tests">
<h3 id="run-tests">运行测试:<a class="headerlink" href="#run-tests" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ctest
./run_tests.py
</pre></div>
</div>
</section>
<section id="update-test-references">
<h3 id="update-test-references">Update test references:<a class="headerlink" href="#update-test-references" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./run_tests.py<span class="w"> </span>-u
</pre></div>
</div>
</section>
<section id="run-integration-tests">
<h3 id="run-integration-tests">Run integration tests<a class="headerlink" href="#run-integration-tests" title="永久链接至标题">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>integration_tests
./run_tests.py
</pre></div>
</div>
</section>
<section id="speed-up-integration-tests-on-macos">
<h3 id="speed-up-integration-tests-on-macos">Speed up integration tests on macOS<a class="headerlink" href="#speed-up-integration-tests-on-macos" title="永久链接至标题">¶</a></h3>
<p>Integration tests run slowly because Apple checks the hash of each executable online before running.</p>
<p>You can turn off that feature in the Privacy tab of the Security and Privacy item of System Preferences &gt; Developer Tools &gt; Terminal.app &gt; “allow the apps below to run software locally that does not meet the system’s security
policy.”</p>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../" title="LFortran 文档"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> LFortran 文档 </span>
              </div>
            </a>
          
          
            <a href="../language/" title="Fortran 语言"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Fortran 语言 </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022 LFortran contributors.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>