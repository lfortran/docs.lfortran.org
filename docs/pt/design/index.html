
<!DOCTYPE html>

<html lang="pt">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Design do LFortran &#8212; LFortran</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ansi.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/lfortran-logo.svg"/>
    <link rel="index" title="Índice" href="../genindex/" />
    <link rel="search" title="Pesquisar" href="../search/" />
    <link rel="next" title="Tutorial de Desenvolvedor" href="../developer_tutorial/" />
    <link rel="prev" title="Progresso no Desenvolvimento do LFortran" href="../progress/" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=amber data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#design" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../" title="LFortran"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/lfortran-logo.svg" height="26"
                   alt="LFortran logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">LFortran Documentation</span>
          <span class="md-header-nav__topic"> Design do LFortran </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search/" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
          </div>
        </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Versions</button>
    <div class="dropdown-content md-hero">
          <a title="English" href="/../en/">English</a>
      
          <a title="Bengali" href="/../bn/">Bengali</a>
      
          <a title="Czech" href="/../cs/">Czech</a>
      
          <a title="German" href="/../de/">German</a>
      
          <a title="Spanish" href="/../es/">Spanish</a>
      
          <a title="French" href="/../fr/">French</a>
      
          <a title="Japanese" href="/../ja/">Japanese</a>
      
          <a title="Dutch" href="/../nl/">Dutch</a>
      
          <a title="Polish" href="/../pl/">Polish</a>
      
          <a title="Portuguese" href="/../pt/">Portuguese</a>
      
          <a title="Russian" href="/../ru/">Russian</a>
      
          <a title="Chinese" href="/../zh_CN/">Chinese</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../" class="md-tabs__link">LFortran</a></li>
            
            <li class="md-tabs__item"><a href="../installation/" class="md-tabs__link">Getting started</a></li>
            
            <li class="md-tabs__item"><a href="../progress/" class="md-tabs__link">LFortran Development Status</a></li>
            
            <li class="md-tabs__item"><a href="#" class="md-tabs__link">Developers's Guide</a></li>
            
            <li class="md-tabs__item"><a href="../intrinsics/array/" class="md-tabs__link">Intrinsics</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../" title="LFortran" class="md-nav__button md-logo">
      
        <img src="../_static/lfortran-logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../"
       title="LFortran">LFortran Documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Começando</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation/" class="md-nav__link">Instalação</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language/" class="md-nav__link">Linguagem Fortran</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Progresso no Desenvolvimento do LFortran</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/" class="md-nav__link">Progresso no Desenvolvimento do LFortran</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/#topics" class="md-nav__link">Tópicos</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Guia do Desenvolvedor</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Design do LFortran </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Design do LFortran</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#design--page-root" class="md-nav__link">Design do LFortran</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#high-level-overview" class="md-nav__link">Visão Geral de Alto Nível</a>
        </li>
        <li class="md-nav__item"><a href="#asr-design-details" class="md-nav__link">Detalhes do design da ASR</a>
        </li>
        <li class="md-nav__item"><a href="#notes" class="md-nav__link">Notas:</a>
        </li>
        <li class="md-nav__item"><a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
        </li>
        <li class="md-nav__item"><a href="#lfortran-extension" class="md-nav__link">Extensão do LFortran</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#example-1" class="md-nav__link">Exemplo 1</a>
        </li>
        <li class="md-nav__item"><a href="#example-2" class="md-nav__link">Exemplo 2</a>
        </li>
        <li class="md-nav__item"><a href="#example-3" class="md-nav__link">Exemplo 3</a>
        </li>
        <li class="md-nav__item"><a href="#example-4" class="md-nav__link">Exemplo 4</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#design-considerations" class="md-nav__link">Considerações de Design</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#high-level-overview" class="md-nav__link">Visão Geral de Alto Nível</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#asr-design-details" class="md-nav__link">Detalhes do design da ASR</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#notes" class="md-nav__link">Notas:</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#lfortran-extension" class="md-nav__link">Extensão do LFortran</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#design-considerations" class="md-nav__link">Considerações de Design</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../developer_tutorial/" class="md-nav__link">Tutorial de Desenvolvedor</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../ast_and_asr/" class="md-nav__link">Diferenças entre uma AST e uma ASR</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contributing/" class="md-nav__link">Contribuindo</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Funções Intrínsecas do LFortran</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/array/" class="md-nav__link">Funções Intrínsecas em Arrays</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/bit/" class="md-nav__link">Funções Intrínsecas de Bits</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/character/" class="md-nav__link">Funções Intrínsecas para Caracteres</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/kind-type/" class="md-nav__link">Kind Type Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/mathematical/" class="md-nav__link">Mathematical Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/numeric/" class="md-nav__link">Numeric Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/misc/" class="md-nav__link">Miscellaneous Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran ASR Nodes</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/cast_kind_nodes/cast_kind/" class="md-nav__link">cast_kind</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/kinds_nodes/kinds/" class="md-nav__link">kinds</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/symbol_nodes/symbol/" class="md-nav__link">symbol</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/type_nodes/ttype/" class="md-nav__link">ttype</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#design--page-root" class="md-nav__link">Design do LFortran</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#high-level-overview" class="md-nav__link">Visão Geral de Alto Nível</a>
        </li>
        <li class="md-nav__item"><a href="#asr-design-details" class="md-nav__link">Detalhes do design da ASR</a>
        </li>
        <li class="md-nav__item"><a href="#notes" class="md-nav__link">Notas:</a>
        </li>
        <li class="md-nav__item"><a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
        </li>
        <li class="md-nav__item"><a href="#lfortran-extension" class="md-nav__link">Extensão do LFortran</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#example-1" class="md-nav__link">Exemplo 1</a>
        </li>
        <li class="md-nav__item"><a href="#example-2" class="md-nav__link">Exemplo 2</a>
        </li>
        <li class="md-nav__item"><a href="#example-3" class="md-nav__link">Exemplo 3</a>
        </li>
        <li class="md-nav__item"><a href="#example-4" class="md-nav__link">Exemplo 4</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#design-considerations" class="md-nav__link">Considerações de Design</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="lfortran-design">
<h1 id="design--page-root">Design do LFortran<a class="headerlink" href="#design--page-root" title="Link permanente para este título">¶</a></h1>
<section id="high-level-overview">
<h2 id="high-level-overview">Visão Geral de Alto Nível<a class="headerlink" href="#high-level-overview" title="Link permanente para este título">¶</a></h2>
<p>LFortran está estruturado em torno de dois módulos independentes, AST e ASR, ambos autônomos (completamente independentes do resto do projeto) e os utilizadores são encorajados a utilizá-los independentemente para outras aplicações e a construir ferramentas com base nisso:</p>
<ul class="simple">
<li><p>Árvore de Sintaxe Abstrata (AST), módulo <code class="docutils literal notranslate"><span class="pre">lfortran.ast</span></code>: representa qualquer código-fonte Fortran, estritamente baseado na sintaxe, nenhuma semântica está incluída. O módulo AST pode ser convertido em código em Fortran.</p></li>
<li><p>Representação Semântica Abstrata (ASR), o módulo <code class="docutils literal notranslate"><span class="pre">lfortran.asr</span></code>: representa um código-fonte Fortran válido, toda a semântica está incluída. Não é permitido códigos inválidos em Fortran (será dado um erro). O módulo ASR pode ser convertido em uma AST.</p></li>
</ul>
<p>O compilador LFortran é então composto pelas seguintes etapas independentes:</p>
<ul class="simple">
<li><p>Análise: converte o código-fonte Fortran em uma AST</p></li>
<li><p>Semântica: converte uma AST em uma ASR</p></li>
<li><p>Otimizações de alto nível: otimiza a ASR para uma simplificá-la e possivelmente torná-la mais rápida (coisas como alinhamento de funções, eliminação de expressões ou comandos redundantes, etc.)</p></li>
<li><p>Geração de código LLVM IR e otimizações de baixo nível: converte uma ASR em uma LLVM IR. Nesta etapa são feitas outras otimizações que não produzem uma ASR, porém ainda faz sentido fazê-las antes de passá-las ao LLVM IR.</p></li>
<li><p>Geração de código de máquina: LLVM fará todas as suas otimizações e gerará código de máquina (como um executável, uma biblioteca, um arquivo objeto, ou carregado e executado usando JIT como parte de uma sessão interativa LFortran ou em um kernel do Jupyter).</p></li>
</ul>
<p>O LFortran está estruturado em forma de uma biblioteca, podendo ser usado para obter uma AST, ou usar o analisador semântico para obter uma ASR, podendo usá-las em uma aplicação. Também é possível gerar uma ASR diretamente (Ex: a partir do SymPy) e depois convertê-la a uma AST, para em seguida montar um código em Fortran, ou usar o LFortran para compilá-la em código de máquina diretamente. Em outras palavras, é fácil usar o LFortran para converter facilmente entre às três representações equivalentes:</p>
<ul class="simple">
<li><p>Código-fonte em Fortran</p></li>
<li><p>Árvore de Sintaxe Abstrata (AST)</p></li>
<li><p>Representação Semântica Abstrata (ASR)</p></li>
</ul>
<p>São todos equivalentes, no seguinte sentido:</p>
<ul class="simple">
<li><p>Qualquer ASR pode ser convertida em uma AST equivalente</p></li>
<li><p>Qualquer AST pode sempre ser convertida em um código Fortran equivalente</p></li>
<li><p>Qualquer código-fonte em Fortran pode ser sempre convertido em uma AST equivalente ou é emitido um erro de sintaxe</p></li>
<li><p>Qualquer AST pode ser sempre convertida em uma ASR equivalente ou é emitido um erro de semântica</p></li>
</ul>
<p>Então, quando a conversão pode ser realizada, são equivalentes, e esta pode sempre ser realizada, exceto no caso em que o código é invalido.</p>
</section>
<section id="asr-design-details">
<h2 id="asr-design-details">Detalhes do design da ASR<a class="headerlink" href="#asr-design-details" title="Link permanente para este título">¶</a></h2>
<p>A ASR foi imaginada para ter os seguintes recursos:</p>
<ul class="simple">
<li><p>A ASR sempre é equivalente semanticamente ao código original Fortran (não perde nenhuma informação). A ASR pode ser convertida em uma AST, e a AST em código-fonte cuja funcionalidade é idêntica a original.</p></li>
<li><p>A ASR é a mais simples possível: não contém nenhuma informação que não pode ser inferida de uma ASR.</p></li>
<li><p>The ASR C++ classes (down the road) are designed similarly to SymEngine: they
are constructed once and after that they are immutable. The constructor
checks in Debug more that all the requirements are met (e.g., that all
Variables in a Function have a dummy argument set, that explicit-shape arrays
are not allocatable and all other Fortran requirements to make it a valid
code), but in Release mode it quickly constructs the class without checks.
Then there are builder classes that construct the ASR C++ classes to meet
requirements (checked in Debug mode) and the builder gives an error message
if a code is not a valid Fortran code, and if it doesn’t give an error
message, then the ASR C++ classes are constructed correctly. Thus by
construction, the ASR classes always contain valid Fortran code and the rest
of LFortran can depend on it.</p></li>
</ul>
</section>
<section id="notes">
<h2 id="notes">Notas:<a class="headerlink" href="#notes" title="Link permanente para este título">¶</a></h2>
<p>Informação perdida ao construir a ASR a partir do código-fonte: espaços em branco, distinção entre os comandos if na mesma linha e if ao longo de várias linhas, além das letras maiúsculas e minúsculas em palavras-chave.</p>
<p>Informação perdida quando transformando uma AST em ASR: sintaxe detalhada de como as variáveis foram definidas e a ordem dos atributos de tipo (se a dimensão de um array está usando o atributo <code class="docutils literal notranslate"><span class="pre">dimension</span></code> ou uma expressão parentesada, ou ainda quantas variáveis existiam na linha, ou sua ordem), já que a ASR apenas representa as informações de tipo em uma tabela de símbolos.</p>
<p>ASR is the simplest way to generate Fortran code, as one does not
have to worry about the detailed syntax (as in AST) about how and where
things are declared. One specifies the symbol table for a module, then for
each symbol (functions, global variables, types, …) one specifies the local
variables and if this is an interface then one needs to specify where one can
find an implementation, otherwise a body is supplied with statements, those
nodes are almost the same as in AST, except that each variable is just a
reference to a symbol in the symbol table (so by construction one cannot have
undefined variables). The symbol table for each node such as Function or Module
also references its parent (for example a function references a module,
a module references the global scope).</p>
<p>The ASR can be directly converted to an AST without gathering any other
information. And the AST directly to Fortran source code.</p>
<p>The ASR is always representing a semantically valid Fortran code.  This is
enforced by checks in the ASR C++ constructors (in Debug build).
When an ASR is used, one can assume it is valid.</p>
</section>
<section id="fortran-2008">
<h2 id="fortran-2008">Fortran 2008<a class="headerlink" href="#fortran-2008" title="Link permanente para este título">¶</a></h2>
<p>Fortran 2008 <a class="reference external" href="https://j3-fortran.org/doc/year/10/10-007.pdf">standard</a> chapter
2 «Fortran concepts» specifies that Fortran code is a collection of <em>program
units</em> (either all in one file, or in separate files), where each <em>program
unit</em> is one of:</p>
<ul class="simple">
<li><p>Programa principal</p></li>
<li><p>módulo ou submódulo</p></li>
<li><p>função ou sub-rotina</p></li>
</ul>
<p>Note: It can also be a <em>block data</em> program unit, that is used to provide
initial values for data objects in named <em>common blocks</em>, but we do not
recommend the use of <em>common blocks</em> (use modules instead).</p>
</section>
<section id="lfortran-extension">
<h2 id="lfortran-extension">Extensão do LFortran<a class="headerlink" href="#lfortran-extension" title="Link permanente para este título">¶</a></h2>
<p>We extend the Fortran language by introducing a <em>global scope</em>, which is not
only the list of <em>program units</em> (as in F2008) but can also include statements,
declarations, use statements and expressions. We define <em>global scope</em> as a
collection of the following items:</p>
<ul class="simple">
<li><p>Programa principal</p></li>
<li><p>módulo ou submódulo</p></li>
<li><p>função ou sub-rotina</p></li>
<li><p>comando use</p></li>
<li><p>declaração</p></li>
<li><p>comando</p></li>
<li><p>expressão</p></li>
</ul>
<p>In addition, if a variable is not defined in an assignment statement (such as
<code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">5+3</span></code>) then the type of the variable is inferred from the right hand side
(e.g., <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">5+3</span></code> would be of type <code class="docutils literal notranslate"><span class="pre">integer</span></code>, and <code class="docutils literal notranslate"><span class="pre">y</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">5._dp</span></code>
would be of type <code class="docutils literal notranslate"><span class="pre">real(dp)</span></code>). This rule only applies at the top level of
<em>global scope</em>. Types must be fully specified inside main programs, modules,
functions and subroutines, just like in F2008.</p>
<p>The <em>global scope</em> has its own symbol table. The main program and
module/submodule do not see any symbols from this symbol table. But functions,
subroutines, statements and expressions at the top level of <em>global scope</em> use
and operate on this symbol table.</p>
<p>The <em>global scope</em> has the following symbols predefined in the symbol table:</p>
<ul class="simple">
<li><p>the usual standard set of Fortran functions (such as <code class="docutils literal notranslate"><span class="pre">size</span></code>,
<code class="docutils literal notranslate"><span class="pre">sin</span></code>, <code class="docutils literal notranslate"><span class="pre">cos</span></code>, …)</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">dp</span></code> double precision symbol, so that one can use <code class="docutils literal notranslate"><span class="pre">5._dp</span></code> for double
precision.</p></li>
</ul>
<p>Each item in the <em>global scope</em> is interpreted as follows: main program is
compiled into an executable with the same name and executed; modules,
functions and subroutines are compiled and loaded; use statement and
declaration adds those symbols with the proper type into the <em>global scope</em>
symbol table, but do not generate any code; statement is wrapped into an
anonymous subroutine with no arguments, compiled, loaded and executed;
expression is wrapped into an anonymous function with no arguments returning
the expression, compiled, loaded, executed and the return value is returned
to the user.</p>
<p>The <em>global scope</em> is always interpreted, item by item, per the previous
paragraph. It is meant to allow interactive usage, experimentations and
writing simple scripts. Code in <em>global scope</em> must be interpreted using
<code class="docutils literal notranslate"><span class="pre">lfortran</span></code>. For more complex (production) code it is recommended to turn it
into modules and programs (by wrapping loose statements into subroutines or
functions and by adding type declarations) and compile it with <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> or
any other Fortran compiler.</p>
<p>Here are some examples of valid code in <em>global scope</em>:</p>
<section id="example-1">
<h3 id="example-1">Exemplo 1<a class="headerlink" href="#example-1" title="Link permanente para este título">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
<span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="example-2">
<h3 id="example-2">Exemplo 2<a class="headerlink" href="#example-2" title="Link permanente para este título">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>

<span class="k">subroutine </span><span class="n">p</span><span class="p">()</span><span class="w"></span>
<span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="k">end subroutine</span>

<span class="k">call </span><span class="n">p</span><span class="p">()</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="example-3">
<h3 id="example-3">Exemplo 3<a class="headerlink" href="#example-3" title="Link permanente para este título">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">module </span><span class="n">a</span><span class="w"></span>
<span class="k">implicit none</span>
<span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="k">end module</span>

<span class="k">use </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">i</span><span class="w"></span>
<span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="w"></span>
</pre></div>
</div>
</section>
<section id="example-4">
<h3 id="example-4">Exemplo 4<a class="headerlink" href="#example-4" title="Link permanente para este título">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w"></span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="w"></span>
<span class="k">call </span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s2">"o-"</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
</section>
</section>
<section id="design-considerations">
<h2 id="design-considerations">Considerações de Design<a class="headerlink" href="#design-considerations" title="Link permanente para este título">¶</a></h2>
<p>The LFortran extension of Fortran was chosen in a way so as to minimize the
number of changes. In particular, only the top level of the <em>global scope</em>
has relaxed some of the Fortran rules (such as making specifying types
optional) so as to allow simple and quick interactive usage, but inside
functions, subroutines, modules or programs this relaxation does not apply.</p>
<p>The number of changes were kept to minimum in order to make it
straightforward to turn code at <em>global scope</em> into standard compliant
Fortran code using programs and modules, so that it can be compiled by any
Fortran compiler.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../progress/" title="Progresso no Desenvolvimento do LFortran"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Progresso no Desenvolvimento do LFortran </span>
              </div>
            </a>
          
          
            <a href="../developer_tutorial/" title="Tutorial de Desenvolvedor"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Tutorial de Desenvolvedor </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022 LFortran contributors.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>