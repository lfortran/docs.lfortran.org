
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>LFortran-Design &#8212; LFortran</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/ansi.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/translations.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="shortcut icon" href="../_static/lfortran-logo.svg"/>
    <link rel="index" title="Stichwortverzeichnis" href="../genindex/" />
    <link rel="search" title="Suche" href="../search/" />
    <link rel="next" title="Tutorial für Entwickler" href="../developer_tutorial/" />
    <link rel="prev" title="LFortran Development Status" href="../progress/" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=amber data-md-color-accent=orange>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#design" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../" title="LFortran"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/lfortran-logo.svg" height="26"
                   alt="LFortran logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">LFortran Documentation</span>
          <span class="md-header-nav__topic"> LFortran-Design </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search/" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
          </div>
        </div>
      
      
  
  <div class="md-flex__cell md-flex__cell--shrink dropdown">
    <button class="dropdownbutton">Versions</button>
    <div class="dropdown-content md-hero">
          <a title="English" href="/../en/">English</a>
      
          <a title="Bengali" href="/../bn/">Bengali</a>
      
          <a title="Czech" href="/../cs/">Czech</a>
      
          <a title="German" href="/../de/">German</a>
      
          <a title="Spanish" href="/../es/">Spanish</a>
      
          <a title="French" href="/../fr/">French</a>
      
          <a title="Japanese" href="/../ja/">Japanese</a>
      
          <a title="Dutch" href="/../nl/">Dutch</a>
      
          <a title="Polish" href="/../pl/">Polish</a>
      
          <a title="Portuguese" href="/../pt/">Portuguese</a>
      
          <a title="Russian" href="/../ru/">Russian</a>
      
          <a title="Chinese" href="/../zh_CN/">Chinese</a>
      
    </div>
  </div>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../" class="md-tabs__link">LFortran</a></li>
            
            <li class="md-tabs__item"><a href="../installation/" class="md-tabs__link">Getting started</a></li>
            
            <li class="md-tabs__item"><a href="../progress/" class="md-tabs__link">LFortran Development Status</a></li>
            
            <li class="md-tabs__item"><a href="#" class="md-tabs__link">Developers's Guide</a></li>
            
            <li class="md-tabs__item"><a href="../intrinsics/array/" class="md-tabs__link">Intrinsics</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../" title="LFortran" class="md-nav__button md-logo">
      
        <img src="../_static/lfortran-logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../"
       title="LFortran">LFortran Documentation</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/lfortran/lfortran" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    LFortran
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Erste Schritte</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation/" class="md-nav__link">Installation</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../language/" class="md-nav__link">Fortran Language</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/" class="md-nav__link">LFortran User Guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran Development Status</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/" class="md-nav__link">LFortran Development Status</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../progress/#topics" class="md-nav__link">Topics</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Developer's Guide</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> LFortran-Design </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">LFortran-Design</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#design--page-root" class="md-nav__link">LFortran-Design</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#high-level-overview" class="md-nav__link">Allgemeine Übersicht</a>
        </li>
        <li class="md-nav__item"><a href="#asr-design-details" class="md-nav__link">Details zum ASR-Design</a>
        </li>
        <li class="md-nav__item"><a href="#compilation-modes" class="md-nav__link">Compilation Modes</a>
        </li>
        <li class="md-nav__item"><a href="#notes" class="md-nav__link">Anmerkungen:</a>
        </li>
        <li class="md-nav__item"><a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
        </li>
        <li class="md-nav__item"><a href="#lfortran-extension" class="md-nav__link">LFortran-Erweiterung</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#example-1" class="md-nav__link">Beispiel 1</a>
        </li>
        <li class="md-nav__item"><a href="#example-2" class="md-nav__link">Beispiel 2</a>
        </li>
        <li class="md-nav__item"><a href="#example-3" class="md-nav__link">Beispiel 3</a>
        </li>
        <li class="md-nav__item"><a href="#example-4" class="md-nav__link">Beispiel 4</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#design-considerations" class="md-nav__link">Design Entscheidungen</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="#high-level-overview" class="md-nav__link">Allgemeine Übersicht</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#asr-design-details" class="md-nav__link">Details zum ASR-Design</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#compilation-modes" class="md-nav__link">Compilation Modes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#notes" class="md-nav__link">Anmerkungen:</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#lfortran-extension" class="md-nav__link">LFortran-Erweiterung</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="#design-considerations" class="md-nav__link">Design Entscheidungen</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../developer_tutorial/" class="md-nav__link">Tutorial für Entwickler</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../ast_and_asr/" class="md-nav__link">Unterschied zwischen AST und ASR</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../contributing/" class="md-nav__link">Beitragen</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran Intrinsics</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/array/" class="md-nav__link">Array Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/bit/" class="md-nav__link">Bit Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/character/" class="md-nav__link">Character Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/kind-type/" class="md-nav__link">Kind Type Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/mathematical/" class="md-nav__link">Mathematical Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/numeric/" class="md-nav__link">Numeric Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../intrinsics/misc/" class="md-nav__link">Miscellaneous Intrinsic Functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">LFortran ASR Nodes</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/cast_kind_nodes/cast_kind/" class="md-nav__link">cast_kind</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/expression_nodes/expression_nodes/" class="md-nav__link">ASR Expression Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/kinds_nodes/kinds/" class="md-nav__link">kinds</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/statement_nodes/statement_nodes/" class="md-nav__link">ASR Statement Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/symbol_nodes/symbol_nodes/" class="md-nav__link">ASR Symbol Nodes</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../asr/asr_nodes/type_nodes/ttype/" class="md-nav__link">ttype</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#design--page-root" class="md-nav__link">LFortran-Design</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#high-level-overview" class="md-nav__link">Allgemeine Übersicht</a>
        </li>
        <li class="md-nav__item"><a href="#asr-design-details" class="md-nav__link">Details zum ASR-Design</a>
        </li>
        <li class="md-nav__item"><a href="#compilation-modes" class="md-nav__link">Compilation Modes</a>
        </li>
        <li class="md-nav__item"><a href="#notes" class="md-nav__link">Anmerkungen:</a>
        </li>
        <li class="md-nav__item"><a href="#fortran-2008" class="md-nav__link">Fortran 2008</a>
        </li>
        <li class="md-nav__item"><a href="#lfortran-extension" class="md-nav__link">LFortran-Erweiterung</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#example-1" class="md-nav__link">Beispiel 1</a>
        </li>
        <li class="md-nav__item"><a href="#example-2" class="md-nav__link">Beispiel 2</a>
        </li>
        <li class="md-nav__item"><a href="#example-3" class="md-nav__link">Beispiel 3</a>
        </li>
        <li class="md-nav__item"><a href="#example-4" class="md-nav__link">Beispiel 4</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#design-considerations" class="md-nav__link">Design Entscheidungen</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section class="tex2jax_ignore mathjax_ignore" id="lfortran-design">
<h1 id="design--page-root">LFortran-Design<a class="headerlink" href="#design--page-root" title="Link zu dieser Überschrift">¶</a></h1>
<section id="high-level-overview">
<h2 id="high-level-overview">Allgemeine Übersicht<a class="headerlink" href="#high-level-overview" title="Link zu dieser Überschrift">¶</a></h2>
<p>LFortran ist um zwei unabhängige Module herum aufgebaut, AST und ASR, die beide eigenständig sind (völlig unabhängig vom Rest von LFortran), und die Benutzer werden ermutigt, sie unabhängig für andere Anwendungen zu verwenden und darauf aufbauende Werkzeuge zu erstellen:</p>
<ul class="simple">
<li><p>Abstrakter Syntaxbaum (abstract syntax tree, AST), Modul <code class="docutils literal notranslate"><span class="pre">lfortran.ast</span></code>: Stellt einen beliebigen Fortran-Quellcode dar, der ausschließlich auf der Syntax basiert und keine Semantik enthält. Das AST-Modul kann sich selbst in Fortran-Quellcode umwandeln.</p></li>
<li><p>Abstrakte semantische Repräsentation (abstract semantic representation, ASR), Modul <code class="docutils literal notranslate"><span class="pre">lfortran.asr</span></code>: Stellt einen gültigen Fortran-Quellcode dar, die gesamte Semantik ist enthalten. Ungültiger Fortran-Code ist nicht erlaubt (es wird ein Fehler ausgegeben). Das ASR-Modul kann sich selbst in einen AST umwandeln.</p></li>
</ul>
<p>Der LFortran-Compiler setzt sich dann aus den folgenden unabhängigen Stufen zusammen:</p>
<ul class="simple">
<li><p>Parsing: Konvertiert Fortran-Quellcode in einen AST</p></li>
<li><p>Semantisch: wandelt einen AST in eine ASR um</p></li>
<li><p>Optimierungen auf hoher Ebene: Optimierung der ASR zu einer möglicherweise schnelleren/einfacheren ASR (z. B. Inlining von Funktionen, Beseitigung redundanter Ausdrücke oder Anweisungen usw.)</p></li>
<li><p>LLVM IR-Code-Generierung und Optimierungen auf niedrigerer Ebene: wandelt eine ASR in eine LLVM IR um. In dieser Phase werden auch alle anderen Optimierungen durchgeführt, die keine ASR erzeugen, aber dennoch sinnvoll sind, bevor sie an LLVM IR übergeben werden.</p></li>
<li><p>Erzeugung von Maschinencode: LLVM führt dann alle Optimierungen durch und generiert Maschinencode (z. B. eine binäre ausführbare Datei, eine Bibliothek, eine Objektdatei, oder sie wird geladen und mit JIT als Teil der interaktiven LFortran-Sitzung oder in einem Jupyter-Kernel ausgeführt).</p></li>
</ul>
<p>LFortran ist als Bibliothek strukturiert, und so kann man zum Beispiel den Parser verwenden, um einen AST zu erhalten und etwas damit zu tun, oder man kann dann den semantischen Analysator verwenden, um ASR zu erhalten und etwas damit zu tun. Man kann die ASR direkt generieren (z.B. aus SymPy) und dann entweder in AST und in einen Fortran-Quellcode konvertieren oder LFortran verwenden, um sie direkt in Maschinencode zu kompilieren. Mit anderen Worten, man kann LFortran verwenden, um einfach zwischen den drei äquivalenten Darstellungen zu konvertieren:</p>
<ul class="simple">
<li><p>Fortran-Quellcode</p></li>
<li><p>Abstrakter Syntaxbaum (AST)</p></li>
<li><p>Abstrakte semantische Repräsentation (ASR)</p></li>
</ul>
<p>Sie sind alle im folgenden Sinne gleichwertig:</p>
<ul class="simple">
<li><p>Jeder ASR kann jederzeit in einen entsprechenden AST umgewandelt werden</p></li>
<li><p>Jeder AST kann jederzeit in einen entsprechenden Fortran-Quellcode konvertiert werden</p></li>
<li><p>Jeglicher Fortran-Quellcode kann immer entweder in einen äquivalenten AST konvertiert werden oder man bekommt einen Syntaxfehler</p></li>
<li><p>Jeder AST kann immer entweder in einen äquivalenten ASR umgewandelt werden oder man erhält einen semantischen Fehler</p></li>
</ul>
<p>Wenn also eine Konvertierung möglich ist, sind sie gleichwertig, und die Konvertierung kann immer durchgeführt werden, es sei denn, der Code ist ungültig.</p>
</section>
<section id="asr-design-details">
<h2 id="asr-design-details">Details zum ASR-Design<a class="headerlink" href="#asr-design-details" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die ASR ist mit den folgenden Merkmalen ausgestattet:</p>
<ul class="simple">
<li><p>ASR ist immer noch semantisch äquivalent zum ursprünglichen Fortran-Code (und hat keine semantischen Informationen verloren). ASR kann in AST und AST in Fortran-Quellcode konvertiert werden, welcher funktional dem Original entspricht.</p></li>
<li><p>Die ASR ist so einfach wie möglich: sie enthält keine Informationen, die nicht aus der ASR abgeleitet werden könnten.</p></li>
<li><p>Die ASR C++-Klassen (in Zukunft) sind ähnlich wie die SymEngine konzipiert: Sie werden einmal konstruiert und sind danach unveränderlich. Der Konstruktor prüft im Debug-Modus eher, ob alle Anforderungen erfüllt sind (z.B., dass alle Variablen in einer Funktion ein Dummy-Argument haben, dass explizite Arrays nicht zuweisbar sind und alle anderen Fortran-Anforderungen, um es zu einem gültigen Code zu machen), aber im Release-Modus konstruiert er die Klasse schnell und ohne Prüfungen. Dann gibt es Builder-Klassen, die die ASR-C++-Klassen so konstruieren, dass sie die Anforderungen erfüllen (die im Debug-Modus überprüft werden), und der Builder gibt eine Fehlermeldung aus, wenn ein Code kein gültiger Fortran-Code ist, und wenn er keine Fehlermeldung ausgibt, dann sind die ASR-C++-Klassen korrekt konstruiert. Somit enthalten die ASR-Klassen konstruktionsbedingt immer gültigen Fortran-Code und der Rest von LFortran kann davon abhängen.</p></li>
</ul>
</section>
<section id="compilation-modes">
<h2 id="compilation-modes">Compilation Modes<a class="headerlink" href="#compilation-modes" title="Link zu dieser Überschrift">¶</a></h2>
<p>We support two compilation modes:</p>
<ol class="arabic simple">
<li><p>Monolithic Compilation Mode: The standard compilation mode.
In this mode, LFortran produces empty object files (<code class="docutils literal notranslate"><span class="pre">.o</span></code> files) with <code class="docutils literal notranslate"><span class="pre">-c</span></code> flag (the only reason to produce those is to satisfy existing build systems that typically expect <code class="docutils literal notranslate"><span class="pre">.o</span></code> files to be created). The object code is generated only when main program is encountered: all modules are loaded from <code class="docutils literal notranslate"><span class="pre">.mod</span></code> files and everything compiled and linked at once. When a module is compiled, only a <code class="docutils literal notranslate"><span class="pre">.mod</span></code> file is generated with full code. For files with global procedures, LFortran identifies those automatically and sets <code class="docutils literal notranslate"><span class="pre">generate_code_for_global_procedures</span></code> compiler option to <code class="docutils literal notranslate"><span class="pre">true</span></code> (not exposed to user), which then generates object code only for global procedures (you must thus link these generated <code class="docutils literal notranslate"><span class="pre">.o</span></code> object files with the main program), and rest of the modules are serialized to <code class="docutils literal notranslate"><span class="pre">.mod</span></code> files which do not contain global procedure.</p></li>
<li><p>Separate compilation mode: This mode is enabled with <code class="docutils literal notranslate"><span class="pre">--separate-compilation</span></code> flag. In this mode, LFortran generates full code for each file into object files (<code class="docutils literal notranslate"><span class="pre">.o</span></code> files) with full symbol information. This
is usually the default mode used by most other Fortran compilers. We create object code, and we still create <code class="docutils literal notranslate"><span class="pre">.mod</span></code> files for modules and they contain everything just like for direct mode but when any <code class="docutils literal notranslate"><span class="pre">.mod</span></code> file is loaded, we change all symbols to <code class="docutils literal notranslate"><span class="pre">ExternalUndefined</span></code> ABI. We don’t change the ABI for <code class="docutils literal notranslate"><span class="pre">bind(c)</span></code> (since those are undefined already in object code, the user is responsible to provide an implementation at link time).</p></li>
</ol>
<p>Note: <strong><em>If you enable separate compilation mode, you have to enable it for all the files.</em></strong></p>
</section>
<section id="notes">
<h2 id="notes">Anmerkungen:<a class="headerlink" href="#notes" title="Link zu dieser Überschrift">¶</a></h2>
<p>Informationen, die beim Parsen des Quelltextes in den AST verloren gehen: Leerzeichen, Unterscheidung zwischen mehrzeiligen und einzeiligen if-Anweisungen, Groß- und Kleinschreibung von Schlüsselwörtern.</p>
<p>Informationen, die beim Übergang von AST zu ASR verloren gehen: detaillierte Syntax, wie Variablen definiert wurden, und die Reihenfolge der Typattribute (ob die Arraydimension das Attribut <code class="docutils literal notranslate"><span class="pre">dimension</span></code> oder Klammern bei der Variablen verwendet; oder wie viele Variablen es pro Deklarationszeile gibt oder ihre Reihenfolge), da ASR nur die aggregierten Typinformationen in der Symboltabelle darstellt.</p>
<p>ASR ist der einfachste Weg, Fortran-Code zu erzeugen, da man sich nicht um die detaillierte Syntax (wie in AST) kümmern muss, wie und wo Dinge deklariert werden. Man spezifiziert die Symboltabelle für ein Modul, dann gibt man für jedes Symbol (Funktionen, globale Variablen, Typen, …) die lokalen Variablen an, und wenn es sich um ein Interface handelt, muss man angeben, wo man eine Implementierung finden kann, andernfalls wird ein Body mit Statements bereitgestellt, diese Knoten sind fast die gleichen wie in AST, außer dass jede Variable nur ein Verweis auf ein Symbol in der Symboltabelle ist (also kann man konstruktionsbedingt keine undefinierten Variablen haben). Die Symboltabelle für jeden Knoten, wie z. B. Funktion oder Modul, verweist auch auf seine Eltern (z. B. verweist eine Funktion auf ein Modul, ein Modul auf den globalen Bereich).</p>
<p>Der ASR kann direkt in einen AST umgewandelt werden, ohne dass weitere Informationen erfasst werden müssen. Und der AST direkt in Fortran-Quellcode.</p>
<p>Die ASR stellt immer einen semantisch gültigen Fortran-Code dar.  Dies wird durch Überprüfungen in den ASR-C++-Konstruktoren (im Debug-Build) erzwungen. Wenn eine ASR eingesetzt wird, kann man davon ausgehen, dass sie gültig ist.</p>
</section>
<section id="fortran-2008">
<h2 id="fortran-2008">Fortran 2008<a class="headerlink" href="#fortran-2008" title="Link zu dieser Überschrift">¶</a></h2>
<p>Fortran 2008 <a class="reference external" href="https://j3-fortran.org/doc/year/10/10-007.pdf">Standard</a> Kapitel 2 „Fortran concepts“ left fest, dass Fortran Code eine Sammlung aus <em>program units</em> ist. (entweder alle in einer Datei oder in separaten Dateien), wobei jede <em>program unit</em> eine der folgenden ist:</p>
<ul class="simple">
<li><p>Hauptprogramm (main program)</p></li>
<li><p>Modul oder Submodul</p></li>
<li><p>Funktion oder Subroutine</p></li>
</ul>
<p>Beachte: Es kann auch eine <em>block data</em>-Programmeinheit sein, die verwendet wird, um Anfangswerte für Datenobjekte in benannten <em>common blocks</em> bereitzustellen, aber wir empfehlen die Verwendung von <em>common blocks</em> nicht (verwende stattdessen Module).</p>
</section>
<section id="lfortran-extension">
<h2 id="lfortran-extension">LFortran-Erweiterung<a class="headerlink" href="#lfortran-extension" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir erweitern die Fortran-Sprache, indem wir einen <em>global scope</em>, welcher nicht nur die Liste der <em>program units</em> (wie in F2008) ist, sondern auch include-Anweisungen, Deklarationen, use-Anweisungen und Ausdrücke enthalten kann.Wir definieren den <em>global scope</em> als eine Sammlung der folgenden Elemente:</p>
<ul class="simple">
<li><p>Hauptprogramm (main program)</p></li>
<li><p>Modul oder Submodul</p></li>
<li><p>Funktion oder Subroutine</p></li>
<li><p>use Statement</p></li>
<li><p>Deklarationen (declaration)</p></li>
<li><p>Anweisung (statement)</p></li>
<li><p>Ausdruck (expression)</p></li>
</ul>
<p>Zusätzlich wird, wenn eine Variable in einer Zuweisung (wie beispielsweise <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">5+3</span></code>) nicht definiert ist, der Typ der Variablen aus der rechten Seite abgeleitet (z. B. wäre <code class="docutils literal notranslate"><span class="pre">x</span></code> in <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">5+3</span></code> vom Typ <code class="docutils literal notranslate"><span class="pre">integer</span></code> und <code class="docutils literal notranslate"><span class="pre">y</span></code> in <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">5._dp</span></code> vom Typ <code class="docutils literal notranslate"><span class="pre">real(dp)</span></code>). Diese Regel gilt nur auf der obersten Ebene des <em>global scope</em>. Innerhalb von Hauptprogrammen, Modulen, Funktionen und Unterprogrammen müssen die Typen vollständig angegeben werden, genau wie in F2008.</p>
<p>Der <em>global scope</em> hat seine eigene Symboltabelle. Das Hauptprogramm und das Modul/Submodul sehen keine Symbole aus dieser Symboltabelle. Aber Funktionen, Unterprogramme, Anweisungen und Ausdrücke auf der obersten Ebene des <em>global scope</em> verwenden und operieren mit dieser Symboltabelle.</p>
<p>Für den <em>global scope</em> sind die folgenden Symbole in der Symboltabelle vordefiniert:</p>
<ul class="simple">
<li><p>den üblichen Standardsatz von Fortran-Funktionen (wie <code class="docutils literal notranslate"><span class="pre">size</span></code>, <code class="docutils literal notranslate"><span class="pre">sin</span></code>, <code class="docutils literal notranslate"><span class="pre">cos</span></code>, …)</p></li>
<li><p>das Symbol <code class="docutils literal notranslate"><span class="pre">dp</span></code> für doppelte Genauigkeit, so dass man <code class="docutils literal notranslate"><span class="pre">5._dp</span></code> für doppelte Genauigkeit verwenden kann.</p></li>
</ul>
<p>Jedes Element im <em>global scope</em> wird wie folgt interpretiert: Das Hauptprogramm wird in eine ausführbare Datei mit demselben Namen kompiliert und ausgeführt; Module, Funktionen und Unterprogramme werden kompiliert und geladen; use-Anweisungen und Deklarationen fügen die Symbole mit dem richtigen Typ in die Symboltabelle des <em>global scope</em> ein, erzeugen aber keinen Code; Anweisungen werden in eine anonyme Unterroutine ohne Argumente übertragen, kompiliert, geladen und ausgeführt; Ausdrücke werden in eine anonyme Funktion, die den ursprünglichen Ausdruck zurückgibt, ohne Argumente übertragen kompiliert, geladen, ausgeführt und der Rückgabewert wird an den Benutzer zurückgegeben.</p>
<p>Der <em>global scope</em> wird immer Element für Element interpretiert, wie im vorherigen Absatz beschrieben. Er ist dazu gedacht, interaktive Nutzung, Experimente und das Schreiben einfacher Skripte zu ermöglichen. Code im <em>global scope</em> muss mit <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> interpretiert werden. Für komplexeren (produktiven) Code wird empfohlen, ihn in Module und Programme umzuwandeln (indem man lose Anweisungen in Unterprogramme oder Funktionen umwandelt und Typdeklarationen hinzufügt) und ihn mit <code class="docutils literal notranslate"><span class="pre">lfortran</span></code> oder einem anderen Fortran-Compiler zu kompilieren.</p>
<p>Hier sind einige Beispiele für gültigen Code im <em>global scope</em>:</p>
<section id="example-1">
<h3 id="example-1">Beispiel 1<a class="headerlink" href="#example-1" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
<span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>
</pre></div>
</div>
</section>
<section id="example-2">
<h3 id="example-2">Beispiel 2<a class="headerlink" href="#example-2" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>

<span class="k">subroutine </span><span class="n">p</span><span class="p">()</span>
<span class="k">print</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">a</span>
<span class="k">end subroutine</span>

<span class="k">call </span><span class="n">p</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="example-3">
<h3 id="example-3">Beispiel 3<a class="headerlink" href="#example-3" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">module </span><span class="n">a</span>
<span class="k">implicit none</span>
<span class="kt">integer</span><span class="w"> </span><span class="kd">::</span><span class="w"> </span><span class="n">i</span>
<span class="k">end module</span>

<span class="k">use </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="k">only</span><span class="p">:</span><span class="w"> </span><span class="n">i</span>
<span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span>
</pre></div>
</div>
</section>
<section id="example-4">
<h3 id="example-4">Beispiel 4<a class="headerlink" href="#example-4" title="Link zu dieser Überschrift">¶</a></h3>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span>
<span class="k">call </span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="s2">"o-"</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="design-considerations">
<h2 id="design-considerations">Design Entscheidungen<a class="headerlink" href="#design-considerations" title="Link zu dieser Überschrift">¶</a></h2>
<p>Die LFortran-Erweiterung von Fortran wurde so gewählt, dass die Zahl der Änderungen möglichst gering ist. Insbesondere wurden nur auf der obersten Ebene des <em>global scope</em> einige der Fortran-Regeln gelockert (z.B. die optionale Angabe von Typen), um eine einfache und schnelle interaktive Nutzung zu ermöglichen.</p>
<p>Die Anzahl der Änderungen wurde so gering wie möglich gehalten, um die Umwandlung von <em>global scope</em>-Code in standardkonformen Fortran-Code mit Hilfe von Programmen und Modulen so einfach wie möglich zu gestalten, so dass er von jedem Fortran-Compiler kompiliert werden kann.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="../progress/" title="LFortran Development Status"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> LFortran Development Status </span>
              </div>
            </a>
          
          
            <a href="../developer_tutorial/" title="Tutorial für Entwickler"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Tutorial für Entwickler </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022 LFortran contributors.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>